namespace protocol;

enum MESSAGETYPE : int
{
BEGIN = 0,

INNER_CLOSE_CLIENT = 1,

REQUEST_REGISTER = 2,
RESPONSE_REGISTER = 3,

REQUEST_HEARTBEAT = 4,
RESPONSE_HEARTBEAT = 5,

NOTICE_ENTRANCE_STAGE = 100,
NOTICE_EXIT_STAGE = 101,

REQUEST_PLAYERMOVE = 102,
RESPONSE_PLAYERMOVE =103,

NOTICE_PLAYERPOSITION = 104,

END
}

table INNER_CLOSE_CLIENT
{
completionkey : uint32;
}

table REQUEST_REGISTER
{
player_id : string;
secret_key : string;
}

table RESPONSE_REGISTER
{
player_id : string;
feedback : bool;
}

table REQUEST_HEARTBEAT
{
player_id : string;
}

table RESPONSE_HEARTBEAT
{
player_id : string;
feedback : bool;
}

table NOTICE_ENTRANCE_STAGE
{
player_id : string;
position_x : float;
position_y : float;
position_z : float;
}

table NOTICE_EXIT_STAGE
{
player_id : string;
}

enum MoveDirection : byte {
    NONE = 0,
    FORWARD = 1,
    BACKWARD = 2,
    LEFT = 3,
    RIGHT = 4,
    LEFT_FORWARD = 5,
    RIGHT_FORWARD = 6,
    LEFT_BACKWARD = 7,
    RIGHT_BACKWARD = 8
}

table REQUEST_PLAYERMOVE
{
player_id : string;
direction: MoveDirection;
move_speed : float;
duration : float;
}

table RESPONSE_PLAYERMOVE
{
feedback : bool;
}

table NOTICE_PLAYERPOSITION
{
player_id : string;
direction: MoveDirection;
move_speed : float;
duration : float;
position_x : float;
position_y : float;
position_z : float;
}

union Content
{

INNER_CLOSE_CLIENT,

REQUEST_REGISTER,
RESPONSE_REGISTER,

REQUEST_HEARTBEAT,
RESPONSE_HEARTBEAT,

NOTICE_ENTRANCE_STAGE,
NOTICE_EXIT_STAGE,

REQUEST_PLAYERMOVE ,
RESPONSE_PLAYERMOVE,

NOTICE_PLAYERPOSITION
}


table SERVER_PROTOCOL
{
    message_type : MESSAGETYPE;
    content : Content;
}

root_type SERVER_PROTOCOL;